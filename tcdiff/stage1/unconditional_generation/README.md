

##  1. Generating Random Subjects

This code is largely adopted from (https://github.com/jychoi118/ilvr_adm).
Random face images could be generated by running the following command:
It will store images under `unconditional_samples`.

A pretrained model has to be downloaded and placed in `dcface/pretrained_models/ffhq_10m.pt`.
(Refer to the README in the repository root for instructions on how to download the model.)

```
python unconditional_sampling.py \
      --attention_resolutions 16 \
      --class_cond False \
      --diffusion_steps 1000 \
      --num_samples 16 \
      --batch_size 8 \
      --image_size 256 \
      --learn_sigma True \
      --noise_schedule linear \
      --num_channels 128 \
      --num_head_channels 64 \
      --num_res_blocks 1 \
      --resblock_updown True \
      --use_fp16 False \
      --use_scale_shift_norm True \
      --timestep_respacing 100 \
      --down_N 32 \
      --range_t 20 \
      --save_dir unconditional_samples
```

Note that not all images are front facing without occlusion. Therefore, a good stage1 ID-image should be selected by 
filtering out images with occlusion or not front facing.


## 2. Align the generated images
Align the generated images by running the following command:

```
cd dcface/stage1/align_faces/
python main.py --root ../unconditional_generation/unconditional_samples \
               --save_root ../unconditional_generation/unconditional_samples_aligned
```